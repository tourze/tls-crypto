# TLS-Crypto 开发指南

本文档记录 TLS-Crypto 包的开发进度、已实现和待实现的功能，以及实现计划。

## 图例

- ✅ 已实现
- 🚧 正在实现
- ⏳ 计划实现
- ❌ 暂不实现

## 核心接口

| 接口 | 状态 | 描述 |
|------|------|------|
| ✅ CipherInterface | 已实现 | 对称加密算法接口 |
| ✅ AsymmetricCipherInterface | 已实现 | 非对称加密算法接口 |
| ✅ HashInterface | 已实现 | 哈希函数接口 |
| ✅ MacInterface | 已实现 | 消息认证码接口 |
| ✅ RandomInterface | 已实现 | 随机数生成器接口 |
| ✅ KeyExchangeInterface | 已实现 | 密钥交换算法接口 |
| ✅ KdfInterface | 已实现 | 密钥导出函数接口 |
| ✅ CurveInterface | 已实现 | 椭圆曲线接口 |

## 对称加密算法实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ AES-GCM | 已实现 | AES-GCM (128/192/256位) |
| ✅ AES-CBC | 已实现 | AES-CBC (128/192/256位) |
| ✅ AES-CTR | 已实现 | AES-CTR (128/192/256位) |
| ✅ ChaCha20-Poly1305 | 已实现 | ChaCha20流密码与Poly1305认证 |
| ⏳ 3DES | 计划实现 | 三重DES加密 |

## 非对称加密算法实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ RSA | 已实现 | RSA加密/解密/签名/验证 |
| ✅ ECDSA | 已实现 | 椭圆曲线数字签名算法 |
| ✅ EdDSA | 已实现 | Edwards曲线数字签名算法 (Ed25519/Ed448) |
| ✅ DSA | 已实现 | 数字签名算法 |

## 哈希函数实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ SHA-256 | 已实现 | SHA-256哈希函数 |
| ✅ SHA-384 | 已实现 | SHA-384哈希函数 |
| ✅ SHA-512 | 已实现 | SHA-512哈希函数 |
| ⏳ SHA-1 | 计划实现 | SHA-1哈希函数（不推荐用于安全场景） |
| ⏳ MD5 | 计划实现 | MD5哈希函数（不推荐用于安全场景） |

## 消息认证码实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ HMAC-SHA256 | 已实现 | 基于SHA-256的HMAC |
| ✅ HMAC-SHA384 | 已实现 | 基于SHA-384的HMAC |
| ✅ HMAC-SHA512 | 已实现 | 基于SHA-512的HMAC |
| ⏳ GMAC | 计划实现 | 伽罗瓦消息认证码 |
| ⏳ Poly1305 | 计划实现 | Poly1305消息认证码 |

## 随机数生成器实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ CryptoRandom | 已实现 | 基于PHP内置函数的加密安全随机数生成器 |

## 密钥导出函数实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ HKDF-SHA256 | 已实现 | 基于SHA-256的HKDF |
| ✅ HKDF-SHA384 | 已实现 | 基于SHA-384的HKDF |
| ✅ HKDF-SHA512 | 已实现 | 基于SHA-512的HKDF |
| ⏳ PBKDF2 | 计划实现 | 基于密码的密钥导出函数2 |

## 密钥交换算法实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ ECDHE | 已实现 | 椭圆曲线Diffie-Hellman密钥交换 |
| ⏳ DHE | 计划实现 | Diffie-Hellman密钥交换 |
| ✅ X25519 | 已实现 | 基于Curve25519的密钥交换 |
| ✅ X448 | 已实现 | 基于Curve448的密钥交换 |

## 椭圆曲线实现

| 算法 | 状态 | 描述 |
|------|------|------|
| ✅ NIST P-256 | 已实现 | NIST P-256曲线 |
| ✅ NIST P-384 | 已实现 | NIST P-384曲线 |
| ✅ NIST P-521 | 已实现 | NIST P-521曲线 |
| ✅ Curve25519 | 已实现 | Curve25519曲线 |
| ✅ Curve448 | 已实现 | Curve448曲线 |

## 工厂类方法

| 方法 | 状态 | 描述 |
|------|------|------|
| ✅ createRandom | 已实现 | 创建随机数生成器 |
| ✅ createHash | 已实现 | 创建哈希函数 |
| ✅ createMac | 已实现 | 创建消息认证码 |
| ✅ createCipher | 已实现 | 创建对称加密算法 |
| ✅ createKdf | 已实现 | 创建密钥导出函数 |
| ✅ createAsymmetricCipher | 已实现 | 创建非对称加密算法 |
| ✅ createKeyExchange | 已实现 | 创建密钥交换算法 |
| ✅ createCurve | 已实现 | 创建椭圆曲线 |

## 测试用例

| 测试 | 状态 | 描述 |
|------|------|------|
| ✅ CryptoFactoryTest | 已实现 | 工厂类测试 |
| ✅ SHA256Test | 已实现 | SHA256测试 |
| ✅ SHA384Test | 已实现 | SHA384测试 |
| ✅ SHA512Test | 已实现 | SHA512测试 |
| ✅ HMACTest | 已实现 | HMAC测试 |
| ✅ HKDFTest | 已实现 | HKDF测试 |
| ✅ AesGcmTest | 已实现 | AES-GCM测试 |
| ✅ AesCbcTest | 已实现 | AES-CBC测试 |
| ✅ AesCtrTest | 已实现 | AES-CTR测试 |
| ✅ RSATest | 已实现 | RSA测试 |
| ✅ Ed25519Test | 已实现 | Ed25519签名测试 |
| ⏳ Ed448Test | 计划实现 | Ed448签名测试 |
| ✅ ECDSATest | 已实现 | ECDSA签名测试 |
| ⏳ DSATest | 计划实现 | DSA签名测试 |
| ✅ NISTP256Test | 已实现 | NIST P-256测试 |
| ⏳ NISTP384Test | 计划实现 | NIST P-384测试 |
| ⏳ NISTP521Test | 计划实现 | NIST P-521测试 |
| ✅ ChaCha20Poly1305Test | 已实现 | ChaCha20-Poly1305测试 |
| ✅ X25519Test | 已实现 | X25519密钥交换测试 |
| ✅ X448Test | 已实现 | X448密钥交换测试 |
| ✅ ECDHETest | 已实现 | ECDHE密钥交换测试 |
| ✅ Curve448Test | 已实现 | Curve448曲线测试 |
| ⏳ CryptoRandomTest | 计划实现 | 随机数生成器测试 |

## 文档

| 文档 | 状态 | 描述 |
|------|------|------|
| ✅ README.md | 已实现 | 中文版说明文档 |
| ✅ README.en.md | 已实现 | 英文版说明文档 |
| ✅ DEVELOP.md | 已实现 | 开发指南文档 |

## 实现计划和优先级

### 第一阶段 (已完成)

- ✅ 核心接口定义
- ✅ 基本算法实现 (SHA-256, HMAC, HKDF, AES-GCM, CryptoRandom)
- ✅ 工厂类基本方法
- ✅ 基本测试用例
- ✅ 文档编写

### 第二阶段 (已完成)

- ✅ 完善哈希函数实现 (SHA-384, SHA-512)
- ✅ 完善对称加密算法 (AES-CBC, AES-CTR)
- ✅ 完善MAC实现 (HMAC-SHA384, HMAC-SHA512)
- ✅ 实现基本的非对称加密 (RSA)
- ✅ 补充更多测试用例

### 第三阶段 (已完成)

- ✅ 实现椭圆曲线密码学 (NIST P-256、Curve25519已完成, Curve448框架已实现)
- ✅ 实现密钥交换算法 (ECDHE、X25519已完成, X448框架已实现)
- ✅ 实现更多的非对称算法 (ECDSA、Ed25519已完成)
- ✅ 实现ChaCha20-Poly1305
- ✅ 基本性能优化与安全审计 (已添加错误处理和环境适配)

### 第四阶段

- ✅ 实现剩余的椭圆曲线与非对称算法
- ⏳ 实现更多的密钥导出函数 (PBKDF2)
- ⏳ 实现高级特性与扩展
- ⏳ 完善文档与示例

#### 4.1 完善椭圆曲线与非对称算法 (优先级高)

- ✅ 完成 Ed448 签名算法实现
- ✅ 实现 NIST P-384 曲线及相关操作
- ✅ 实现 NIST P-521 曲线及相关操作
- ✅ 完善 Curve448 实现，添加更多环境兼容性支持
- ✅ 实现 DSA 数字签名算法
- ✅ 完成 ECDHE 密钥派生部分实现

#### 4.2 扩展密码学原语 (优先级中)

- ⏳ 实现 PBKDF2 密钥导出函数
- ⏳ 实现 3DES 对称加密算法
- ⏳ 实现 GMAC 消息认证码
- ⏳ 实现独立的 Poly1305 消息认证码
- ⏳ 实现 DHE 密钥交换算法
- ⏳ 为兼容性考虑实现 SHA-1 和 MD5 哈希函数，并添加安全警告

#### 4.3 性能优化与安全增强 (优先级中)

- ⏳ 对所有已实现算法进行性能基准测试
- ⏳ 实现常量时间比较函数库，防止时间侧信道攻击
- ⏳ 添加安全随机数种子熵评估机制
- ⏳ 实现内存安全处理（敏感数据的安全清除）
- ⏳ 添加密钥材料有效性和强度验证功能

#### 4.4 高级功能与互操作性 (优先级低)

- ⏳ 实现 TLS 1.3 密钥派生函数
- ⏳ 添加 PKCS#7/PKCS#8 密钥格式支持
- ⏳ 实现 JWK/JWS/JWT 支持
- ⏳ 添加 PEM/DER 证书和密钥处理功能
- ⏳ 实现与其他加密库的互操作性测试

#### 4.5 测试与文档 (持续进行)

- ⏳ 实现 CryptoRandomTest 及其他缺失的测试用例
- ⏳ 为所有新实现的功能添加测试用例
- ⏳ 创建更多使用示例和教程文档
- ⏳ 添加性能比较文档
- ⏳ 完善 API 文档，增加更多代码示例
- ⏳ 添加安全最佳实践指南

## 注意事项

- 所有实现应遵循相关RFC标准和最佳实践
- 优先使用PHP内置函数实现，确保性能和安全性
- 所有接口和实现应有完善的文档和测试用例
- 代码应遵循PSR-12编码规范
- 需要防止常见的密码学攻击（如时间侧信道攻击）
